<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trackování Prášků</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        h1, h2 {
            text-align: center;
        }
        .pill-container {
            margin-bottom: 20px;
        }
        .pill-container label {
            display: block;
            margin-bottom: 10px;
        }
        .pill-container input[type="checkbox"] {
            margin-right: 10px;
        }
        .pill-container input[type="text"] {
            margin-left: 10px;
        }
        .log-container {
            margin-top: 20px;
        }
        .log-entry {
            margin-bottom: 10px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Trackování Prášků</h1>
        <div id="date-container">
            <h2>Dnes je: <span id="current-date"></span> (<span id="current-day"></span>)</h2>
        </div>
        <div class="pill-container">
            <label>
                <input type="text" id="pill1-name" value="Prášek 1"> 
                <input type="checkbox" id="pill1-1"> 1. dávka
            </label>
            <label>
                <input type="checkbox" id="pill1-2"> 2. dávka
            </label>
            <label>
                <input type="checkbox" id="pill1-3"> 3. dávka
            </label>
            <label>
                <input type="checkbox" id="pill1-4"> 4. dávka
            </label>
        </div>
        <div class="pill-container">
            <label>
                <input type="text" id="pill2-name" value="Prášek 2"> 
                <input type="checkbox" id="pill2-1"> 1. dávka
            </label>
            <label>
                <input type="checkbox" id="pill2-2"> 2. dávka
            </label>
            <label>
                <input type="checkbox" id="pill2-3"> 3. dávka
            </label>
            <label>
                <input type="checkbox" id="pill2-4"> 4. dávka
            </label>
        </div>
        <div class="pill-container">
            <label>
                <input type="text" id="pill3-name" value="Prášek 3"> 
                <input type="checkbox" id="pill3"> ráno
            </label>
        </div>
        <div class="pill-container">
            <label>
                <input type="text" id="pill4-name" value="Prášek 4"> 
                <input type="checkbox" id="pill4"> ráno
            </label>
        </div>
        <div class="pill-container">
            <label>
                <input type="text" id="pill5-name" value="Prášek 5"> 
                <input type="checkbox" id="pill5"> večer
            </label>
        </div>
        <div class="log-container">
            <h2>Log:</h2>
            <div id="log"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            const dateContainer = document.getElementById('current-date');
            const dayContainer = document.getElementById('current-day');
            const logContainer = document.getElementById('log');
            const pills = document.querySelectorAll('input[type="checkbox"]');
            const pillNames = document.querySelectorAll('input[type="text"]');

            // Funkce pro získání názvu dne v týdnu
            function getDayName(date, locale) {
                return date.toLocaleDateString(locale, { weekday: 'long' });
            }

            // Nastav aktuální datum a den v týdnu
            const today = new Date();
            const currentDate = today.toLocaleDateString('cs-CZ');
            const currentDay = getDayName(today, 'cs-CZ');
            dateContainer.textContent = currentDate;
            dayContainer.textContent = currentDay;

            // Zkontroluj a resetuj checkboxy pokud je nový den
            const savedDate = localStorage.getItem('savedDate');
            if (savedDate !== currentDate) {
                localStorage.clear();
                localStorage.setItem('savedDate', currentDate);
            } else {
                pills.forEach(pill => {
                    pill.checked = localStorage.getItem(pill.id) === 'true';
                });
                pillNames.forEach(pillName => {
                    if (localStorage.getItem(pillName.id)) {
                        pillName.value = localStorage.getItem(pillName.id);
                    }
                });
            }

            // Ulož stav checkboxů do localStorage
            pills.forEach(pill => {
                pill.addEventListener('change', () => {
                    const timestamp = new Date().toLocaleTimeString('cs-CZ');
                    localStorage.setItem(pill.id, pill.checked);
                    localStorage.setItem(`${pill.id}-timestamp`, timestamp);
                    updateLog();
                });
            });

            // Ulož názvy prášků do localStorage
            pillNames.forEach(pillName => {
                pillName.addEventListener('input', () => {
                    localStorage.setItem(pillName.id, pillName.value);
                });
            });

            // Funkce pro aktualizaci logu
            function updateLog() {
                logContainer.innerHTML = '';
                pills.forEach(pill => {
                    const timestamp = localStorage.getItem(`${pill.id}-timestamp`);
                    if (pill.checked) {
                        const pillId = pill.id;
                        const pillNameId = pillId.split('-')[0] + '-name';
                        const pillName = document.getElementById(pillNameId).value;
                        const dose = pillId.split('-')[1];
                        const logEntry = document.createElement('div');
                        logEntry.className = 'log-entry';
                        logEntry.textContent = `${currentDate} - ${pillName} - ${dose ? dose + '. dávka' : pillId.includes('5') ? 'večer' : 'ráno'} - Vzato v ${timestamp}`;
                        logContainer.appendChild(logEntry);
                    }
                });
            }

            updateLog();
        });
    </script>
</body>
</html>
